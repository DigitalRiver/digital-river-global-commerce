"use strict";jQuery(document).ready(function(o){var n,r,a,c=0,i=1,p=[],d=[],u=[],s=dr_object.ajax_url,l=dr_object.ajax_nonce,_=dr_object.dr_ajx_instance_id,h=dr_object.site_id,b=dr_object.api_key,x=o("#dr-data-process-progressbar"),j=o(".wrapImportControls p"),f=o("#products-import-btn");function m(t,e,s){n=t.entries_count,i=t.batch_size,c=t.index_start,o(".wrapImportControls").find("h4").remove(),x.show(),x.progressbar({max:n,value:0}),j.show(),f.hide(),function(t){o("#dr-data-process-total").text(t)}(n),v()}function v(){for(var t,e=0;e<i&&c<n;)p.push(c),c++,e++;p.length?(t={action:"dr_express_ajx_action",step:"batchprocess",persist:r,nonce:l,instance_id:_,itemsBeingProcessed:p},o.ajax({dataType:"json",data:t,type:"post",url:s,context:this,nonce:l,success:y})):function(){x.hide(),o(".wrapImportControls").html("<h3><b>Cleaning up...</b></h3>");var t={action:"dr_express_ajx_action",step:"end",persist:r,nonce:l,instance_id:_};o.ajax({dataType:"json",data:t,type:"post",url:s,context:this,success:w})}()}function y(t,e,s){var n;o.each(t.results,function(t,e){"success"===e?d.push(t):"failure"===e&&u.push(t),n=t}),function(t){a=a||o("#dr-data-process-counter");x.progressbar("option","value",t),a.text(t)}(c),p=[],r=t.results[n].persist,v()}function w(t,e,s){window.location.href=t.url}o("#products-import-btn").on("click",function(t){if(t.preventDefault(),!h||!b)return alert("Please provide siteID & apiKey!");f.attr("disabled","disabled"),o(".notice").is(":visible")&&o(".notice").hide(),o(".wrapImportControls").append("<h4> <b>Fetching products, locales and currencies...</b> </h4>");var e={action:"dr_express_ajx_action",nonce:l,instance_id:_,step:"init"};o.ajax({dataType:"json",data:e,type:"post",url:s,context:this,nonce:l,success:m})})});