"use strict";jQuery(document).ready(function(r){var a,o,c,i=0,p=1,d=[],u=[],l=[],s=dr_object.ajax_url,n=dr_object.ajax_nonce,_=dr_object.dr_ajx_instance_id,h=dr_object.site_id,b=dr_object.api_key,x=r("#dr-data-process-progressbar"),j=r(".wrapImportControls p"),f=r("#products-import-btn");function v(t,e,s){var n;a=t.entries_count,p=t.batch_size,i=t.index_start,r(".wrapImportControls").find("h4").remove(),x.show(),x.progressbar({max:a,value:0}),j.show(),f.hide(),n=a,r("#dr-data-process-total").text(n),m()}function m(){for(var t,e=0;e<p&&i<a;)d.push(i),i++,e++;d.length?(t={action:"dr_express_ajx_action",step:"batchprocess",persist:o,nonce:n,instance_id:_,itemsBeingProcessed:d},r.ajax({dataType:"json",data:t,type:"post",url:s,context:this,nonce:n,success:y})):function(){x.hide(),r(".wrapImportControls").html("<h3><b>Cleaning up...</b></h3>");var t={action:"dr_express_ajx_action",step:"end",persist:o,nonce:n,instance_id:_};r.ajax({dataType:"json",data:t,type:"post",url:s,context:this,success:w})}()}function y(t,e,s){var n;r.each(t.results,function(t,e){"success"===e?u.push(t):"failure"===e&&l.push(t),n=t}),function(t){c||(c=r("#dr-data-process-counter"));x.progressbar("option","value",t),c.text(t)}(i),d=[],o=t.results[n].persist,m()}function w(t,e,s){window.location.href=t.url}r("#products-import-btn").on("click",function(t){if(t.preventDefault(),!h||!b)return alert("Please provide siteID & apiKey!");f.attr("disabled","disabled"),r(".notice").is(":visible")&&r(".notice").hide(),r(".wrapImportControls").append("<h4> <b>Fetching products, locales and currencies...</b> </h4>");var e={action:"dr_express_ajx_action",nonce:n,instance_id:_,step:"init"};r.ajax({dataType:"json",data:e,type:"post",url:s,context:this,nonce:n,success:v})})});