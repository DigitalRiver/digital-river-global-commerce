"use strict";jQuery(document).ready(function(s){var n,r,o,i=0,c=1,p=[],d=[],u=[],e=drgc_admin_params.ajax_url,_=drgc_admin_params.ajax_nonce,l=drgc_admin_params.drgc_ajx_instance_id,h=drgc_admin_params.site_id,m=drgc_admin_params.api_key,f=s("#dr-data-process-progressbar"),g=s(".wrapImportControls p"),x=s("#products-import-btn");function b(t,a,e){n=t.entries_count,c=t.batch_size,i=t.index_start,s(".wrapImportControls").find("h4").remove(),f.show(),f.progressbar({max:n,value:0}),g.show(),x.hide(),function(t){s("#dr-data-process-total").text(t)}(n),j()}function j(){for(var t,a=0;a<c&&i<n;)p.push(i),i++,a++;p.length?(t={action:"drgc_ajx_action",step:"batchprocess",persist:r,nonce:_,instance_id:l,itemsBeingProcessed:p},s.ajax({dataType:"json",data:t,type:"post",url:e,context:this,nonce:_,success:v})):function(){f.hide(),s(".wrapImportControls").html("<h3><b>Cleaning up...</b></h3>");var t={action:"drgc_ajx_action",step:"end",persist:r,nonce:_,instance_id:l};s.ajax({dataType:"json",data:t,type:"post",url:e,context:this,success:y})}()}function v(t,a,e){var n;s.each(t.results,function(t,a){a.success?d.push(t):"failure"===a&&u.push(t),n=t}),function(t){o=o||s("#dr-data-process-counter");f.progressbar("option","value",t),o.text(t)}(i),p=[],r=t.results[n].persist,j()}function y(t,a,e){window.location.href=t.url}s("#products-import-btn").on("click",function(t){if(t.preventDefault(),!h||!m)return alert("Please provide siteID & apiKey!");x.attr("disabled","disabled"),s(".notice").is(":visible")&&s(".notice").hide(),s(".wrapImportControls").append("<h4> <b>Fetching products, locales and currencies...</b> </h4>");var a={action:"drgc_ajx_action",nonce:_,instance_id:l,step:"init"};s.ajax({dataType:"json",data:a,type:"post",url:e,context:this,nonce:_,success:b})})});